(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t){function n(e){var t=e.length,n=[],a=[];n.push(0),a.push(0);for(var o=1;o<t;o+=1)n.push(-1),a.push(o);function r(){for(var n=[],o=0;o<t;o+=1)n.push(e[a[o]]);return n}var i="string"!==typeof e?r:function(){return r().join("")};return function(){var e,o,r;for(e=0;e<t;e+=1)if(0!==n[e]){o=e;break}if(void 0!==o){for(e=o+1;e<t;e+=1)0!==n[e]&&a[e]>a[o]&&(o=e);for(function(e,t){var o=a[e];a[e]=a[t],a[t]=o,o=n[e],n[e]=n[t],n[t]=o}(o,r=o+n[o]),(0===r||r===t-1||a[r+n[r]]>a[r])&&(n[r]=0),e=0;e<t;e+=1)a[e]>a[r]&&(n[e]=e<r?1:-1);return i()}}}n.all=function(e){for(var t=n(e),a=e,o=[];void 0!==a;)o.push(a),a=t();return o},e.exports=n},14:function(e,t,n){},20:function(e,t,n){e.exports=n(45)},25:function(e,t,n){},27:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){},33:function(e,t,n){},43:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(15),i=n.n(r),l=(n(25),n(2)),s=n(3),c=n(5),u=n(4),m=n(6),h=(n(27),n(29),n(31),n(8)),p=n(16),d=n(19),v=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(l.a)(this,e),this.noteArray=t,this.iterator=n,this.generation=a,this.generationIndex=o,this.note=this.noteArray[this.generation][this.generationIndex],this.scaleSize=t[0].length,this.maxIndex=this.noteArray.length*this.noteArray[0].length}return Object(s.a)(e,[{key:"getInfo",value:function(){return{iteration:this.iterator,generation:this.generation,generationIndex:this.generationIndex,note:this.note,scaleSize:this.scaleSize}}},{key:"increment",value:function(){this.iterator++,this.iterator>=this.maxIndex&&(this.iterator=0)}},{key:"getNoteInfo",value:function(){return this.generation=parseInt(this.iterator/this.scaleSize,10),this.generationIndex=this.iterator%this.scaleSize,this.note=this.noteArray[this.generation][this.generationIndex],{iteration:this.iterator,generation:this.generation,generationIndex:this.generationIndex,note:this.note}}},{key:"getInformation",value:function(){return{iteration:this.iterator}}},{key:"playNote",value:function(){var e=this.getNoteInfo();return this.increment(),e}}]),e}(),f=n(1),g=n.n(f),E=n(10),y=n.n(E),b=n(7),S=n.n(b),w=n(9),k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,3,7,12],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"4n",a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"konva-test",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#FFFFFF",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"C",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"minor",s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"4",c=(new g.a.PolySynth).toMaster(),u=e.length,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,1,4,8],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"minor",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"C",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"4",o=[],r=w.a.notes("".concat(n).concat(a," ").concat(t)).length,i=Math.max.apply(Math,Object(d.a)(e));if(i<r)o=w.a.notes("".concat(n).concat(a," ").concat(t));else for(var l,s=Math.floor(i/r)+1,c=0;c<=s;c++)l=w.a.notes("".concat(n).concat(String(parseInt(a,10)+c)," ").concat(t)),o=o.concat(l);return e.map(function(e){return o[e]})}(e,l,i,s),h=function(e,t){var n,a=e.map(function(e,t){return t}),o=(n=a,y.a.all(n));return new v(o,t)}(m,t);h.initialScaleNoteNames=e.map(function(e,t){return m[t]});for(var p=document.getElementById(o).offsetWidth,f=document.getElementById(o).offsetHeight,E=new S.a.Stage({container:o,width:p,height:f}),b=new S.a.Layer,k=[],I=0;I<u;I++)k.push(new S.a.Rect({x:p/u*I,y:0,width:p/u,height:f,fill:r,opacity:.05}));for(var N=0;N<u;N++)b.add(k[N]);for(var C=function(e,t){t[e].tween=new S.a.Tween({node:t[e],opacity:.8,easing:S.a.Easings.EaseOut,duration:.1,onFinish:function(){t[e].tween.reverse()}})},x=0;x<u;x++)C(x,k);return E.add(b),a(h),[new g.a.Loop(function(e){h.playNote(),c.triggerAttackRelease(m[h.note],n),k[h.note].tween.play(),h.note=m[h.note],a(h)},n),h]},I=(n(33),n(14),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).setDefaultLoopState=function(){n.setState({loopState:{noteArray:[0,2,3,5,7,12],initialIteration:0,noteLength:"4n",rooteNote:"C",scaleKey:"minor",octave:4},noteArrayString:"0 4 7"})},n.loopStop=function(e){n.setState({loopPlaying:!1}),e.stop(0)},n.loopStart=function(e){e.start("@1m"),n.setState({loopPlaying:!0})},n.createLoop=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{noteArray:[0,2,5,7,12],initialIteration:0,noteLength:"4n",rooteNote:"C",scaleKey:"minor",octave:4},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0 2 5 7 12";n.setState({loopCreated:!0});var a=t.split(" ").map(function(e){return parseInt(e,10)}).filter(function(e){if(Number.isInteger(e)&&e>=0&&e<30)return!0});return console.log(a),k(a,e.initialIteration,e.noteLength,function(e){n.setState({loopData:e})},n.props.konvaIdName,"#e0e0e0",e.rootNote,e.scaleKey,e.octave)},n.clearLoop=function(){n.setState({loopCreated:!1}),n.setDefaultLoopState()},n.createDefaultLoop=function(e){return console.log("bang"),k()},n.eventHandler=function(e){var t=e.target.id,a=e.target.value,o=function(e,t){n.setState(function(n){return{loopState:Object(p.a)({},n.loopState,Object(h.a)({},e,t))}})};switch(t){case"scaleKey":o("scaleKey",a);break;case"scaleOctave":o("octave",a);break;case"scaleRoot":o("rootNote",a);break;case"noteLength":o("noteLength",a);break;case"scaleIndices":n.setState({noteArrayString:a});break;default:return!0}},n.state={loopCreated:!1,loopState:{noteArray:[0,2,3,5,7,12],initialIteration:0,noteLength:"4n",rooteNote:"C",scaleKey:"minor",octave:4},noteArrayString:"0 4 7",loopPlaying:!1,loopData:{generation:0,generationIndex:0,iterator:0,maxIndex:600,note:0,noteArray:[0,0,0],scaleSize:5},scaleInfo:["C"]},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t=this;return e=this.state.loopCreated?o.a.createElement("div",{className:"createdLoopLayout"},o.a.createElement("div",{className:"createdLoopButtonContainer center-contents"},this.state.loopPlaying?o.a.createElement("a",{className:"SJTUnitButton createdLoopButton center-contents",onClick:function(){return t.loopStop(t.loop[0])}},"Stop Loop"):o.a.createElement("a",{className:"SJTUnitButton createdLoopButton center-contents",onClick:function(){return t.loopStart(t.loop[0])}},"Play Loop")),o.a.createElement("div",{className:"createdLoopButtonContainer center-contents"},o.a.createElement("a",{className:"SJTUnitButton createdLoopButton center-contents",onClick:function(){t.loopStop(t.loop[0]),t.clearLoop()}},"Clear Loop")),o.a.createElement("div",{className:"loopInformation"},o.a.createElement("span",null,"Note: ",this.state.loopData.note),o.a.createElement("span",null,"Scale: ",String(this.state.loopData.initialScaleNoteNames)),o.a.createElement("span",null,"Note Number: ",this.state.loopData.iterator),o.a.createElement("span",null,"Generation: ","".concat(this.state.loopData.generation+1,"/").concat(this.state.loopData.noteArray.length)),o.a.createElement("span",null,"Total Number of Notes: ",this.state.loopData.maxIndex))):o.a.createElement("div",{className:"loopCreationLayout"},o.a.createElement("div",{className:"dataInputUnit center-contents"},o.a.createElement("label",null,"Indices: ",o.a.createElement("div",null,o.a.createElement("input",{type:"text",name:"indices",placeholder:"Default: 0 4 7",onChange:this.eventHandler,id:"scaleIndices",pattern:"(\\d{1,2}\\s){1,6}",size:"10"})))),o.a.createElement("div",{className:"scale-dropdown-menus"},o.a.createElement("div",{className:"dropdown-layout center-contents"},o.a.createElement("label",null,"Root: ",o.a.createElement("div",null,o.a.createElement("select",{defaultValue:"C",onChange:this.eventHandler,id:"scaleRoot"},o.a.createElement("option",{value:"A"},"A"),o.a.createElement("option",{value:"Bb"},"Bb"),o.a.createElement("option",{value:"B"},"B"),o.a.createElement("option",{value:"C"},"C"),o.a.createElement("option",{value:"C#"},"C#"),o.a.createElement("option",{value:"D"},"D"),o.a.createElement("option",{value:"Eb"},"Eb"),o.a.createElement("option",{value:"E"},"E"),o.a.createElement("option",{value:"F"},"F"),o.a.createElement("option",{value:"F#"},"F#"),o.a.createElement("option",{value:"G"},"G"),o.a.createElement("option",{value:"G#"},"G#"))))),o.a.createElement("div",{className:"dropdown-layout center-contents"},o.a.createElement("label",null,"Octave: ",o.a.createElement("div",null,o.a.createElement("select",{defaultValue:"4",onChange:this.eventHandler,id:"scaleOctave"},o.a.createElement("option",{value:"2"},"2"),o.a.createElement("option",{value:"3"},"3"),o.a.createElement("option",{value:"4"},"4"),o.a.createElement("option",{value:"5"},"5"),o.a.createElement("option",{value:"6"},"6"))))),o.a.createElement("div",{className:"dropdown-layout center-contents"},o.a.createElement("label",null,"Key: ",o.a.createElement("select",{defaultValue:"minor",onChange:this.eventHandler,id:"scaleKey"},o.a.createElement("option",{value:"major"},"Major"),o.a.createElement("option",{value:"minor"},"Minor"),o.a.createElement("option",{valye:"dorian"},"Dorian"),o.a.createElement("option",{value:"mixolydian"},"Mixolydian"),o.a.createElement("option",{value:"chromatic"},"Chromatic")))),o.a.createElement("div",{className:"dropdown-layout center-contents"},o.a.createElement("label",null,"Duration:    ",o.a.createElement("div",null,o.a.createElement("select",{defaultValue:"4n",onChange:this.eventHandler,id:"noteLength"},o.a.createElement("option",{value:"2n"},"1/2"),o.a.createElement("option",{value:"4n"},"1/4"),o.a.createElement("option",{value:"8n"},"1/8"),o.a.createElement("option",{value:"16n"},"1/16")))))),o.a.createElement("div",{className:"dataInputUnit center-contents flow-table"},o.a.createElement("a",{className:"SJTUnitButton center-contents",onClick:function(){t.loop=t.createLoop(t.state.loopState,t.state.noteArrayString)}},"Create Loop"),o.a.createElement("a",{className:"SJTUnitButton center-contents",onClick:this.props.externalFunction}," Remove Loop "))),o.a.createElement("div",{className:"buttonHolder"},e)}}]),t}(o.a.Component)),N=n(11),C=n.n(N),x=(n(43),["overlay-styling"]),T=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={hide:!1},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.state.hide&&x.push("hide"),o.a.createElement("div",{className:x.join(" ")},o.a.createElement("div",{className:"overlayText"},o.a.createElement("h1",null,"Steinhaus-Johnson-Trotter Web"),o.a.createElement("p",null,"This is a four-channel change-ringing simulator, built using ",o.a.createElement("a",{href:"https://reactjs.org/"},"Reactjs"),", ",o.a.createElement("a",{href:"https://konvajs.github.io/"},"Konva")," ",o.a.createElement("a",{href:"https://tonejs.github.io/"},"Tonejs")," and the ",o.a.createElement("a",{href:"https://github.com/danigb/tonal"},"Tonal")," library."),"This is best viewed on a laptop/desktop computer",o.a.createElement("h3",null,"How to use"),o.a.createElement("ol",null,o.a.createElement("li",null,"On one of the fields click 'Initialise Loop'"),o.a.createElement("li",null,"Enter the degrees of the scale you wish to use as a pattern (with 0 being the root note of the scale), separated by spaces (e.g. 0 2 4 7) - Up to eight values are permitted"),o.a.createElement("li",null,"Choose a scale root, octave, key and note duration (optional)"),o.a.createElement("li",null,"Click 'Create Loop', which applies Steinhaus-Johnson-Trotter permutations to your sequence"),o.a.createElement("li",null,"Click 'Play Loop' to hear the playback of the permuted sequence, and see visualisation of that sequence ")),o.a.createElement("ul",null,o.a.createElement("li",null,"Loops can be removed with the 'Clear Loop' button"),o.a.createElement("li",null,"Tempo and Volume can be changed using the sliders below the loop fields")),o.a.createElement("h3",null,"Known Issues"),o.a.createElement("ul",null,o.a.createElement("li",null,"Tempo changes can cause playback of loops to stop working"),o.a.createElement("li",null,"Any negative numbers, text and numbers over 30 will be silently rejected from input"),o.a.createElement("li",null,"Changing the dimensions of the browser will not change the dimensions of visuals"),o.a.createElement("li",null,"Sequences are limited to eight notes to prevent crashes from enormous datasets")),o.a.createElement("h3",null,"About the Steinhaus-Johnson-Trotter Algorithm"),o.a.createElement("p",null,"The Steinhaus\u2013Johnson\u2013Trotter algorithm or Johnson\u2013Trotter algorithm, also called plain changes, is an algorithm named after Hugo Steinhaus, Selmer M. Johnson and Hale F. Trotter that generates all of the permutations of n elements. Each permutation in the sequence that it generates differs from the previous permutation by swapping two adjacent elements of the sequence."),o.a.createElement("p",null,'Outside of mathematics, the same method was known for much longer as a method for change ringing of church bells: it gives a procedure by which a set of bells can be rung through all possible permutations, changing the order of only two bells per change. These so-called "plain changes" were recorded as early as 1621 for four bells, and a 1677 book by Fabian Stedman lists the solutions for up to six bells.'),"Information CC BY-SA from ",o.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Steinhaus%E2%80%93Johnson%E2%80%93Trotter_algorithm"},"Wikipedia"),o.a.createElement("div",{className:"bottom-alignment"},o.a.createElement("a",{className:"closeButton",onClick:function(){e.setState({hide:!0})}},"Start"))))}}]),t}(o.a.Component),j=60,L=-3,O=-40,A=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).addSJT=function(){n.setState(function(e,t){return{arrayOfIndexes:e.arrayOfIndexes.push(!0)}})},n.invertState=function(e){var t=n.state.arrayOfIndexes;t[e]=!t[e],n.setState({arrayOfIndexes:t})},n.removeFromArray=function(e){var t=n.state.arrayOfIndexes;t=t.splice(e,1),n.setState({arrayOfIndexes:t})},n.addToArray=function(e){var t=n.state.arrayOfIndexes;t=t.push(!0),n.setState({arrayOfIndexes:t})},n.testFunction=function(e){console.log("works",e)},n.setBpm=function(e){var t;"object"===typeof e?t=parseInt(e.target.value,10):"number"===typeof e&&(t=parseInt(e,10));var a=n.state.tempoValue,o=Math.abs(t-a);isFinite(t)&&(o<=2?(g.a.Transport.bpm.value=t,n.setState({tempoValue:t})):o<10?(n.setState({tempoValue:t}),g.a.Transport.bpm.rampTo(t,o/50)):(n.setState({tempoValue:t}),g.a.Transport.bpm.rampTo(t,1)))},n.setVolume=function(e){var t;"object"===typeof e?t=parseFloat(e.target.value):"number"===typeof e&&(t=parseFloat(e,10)),isFinite(t)&&(parseInt(t,10)===O?(g.a.Master.mute=!0,n.setState({muted:!0})):parseInt(t,10)!==O&&!0===n.state.muted&&(g.a.Master.mute=!1,n.setState({muted:!1})),n.setState({volume:t}),g.a.Master.volume.rampTo(t,.1))},n.convertRange=function(e,t,n){return(e-t[0])*(n[1]-n[0])/(t[1]-t[0])+n[0]},n.state={arrayOfIndexes:[!1,!1,!1,!1],tempoValue:j,volume:L,colours:["rgba(71, 151, 97, 0.5)","rgba(161, 110, 131, 0.5)","rgba(206, 188, 129, 0.5)","rgba(177, 159, 158, 0.5)"],muted:!1},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){g.a.Transport.start("+0.1"),g.a.Transport.bpm.value=j,g.a.Master.volume.value=L}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"container"},o.a.createElement(T,null),this.state.arrayOfIndexes.map(function(t,n){return t?o.a.createElement("div",{className:"div-styling",style:{background:e.state.colours[n]}},o.a.createElement("div",{className:"konva-container",id:"konva-".concat(n)}),o.a.createElement("div",{className:"SJTUnit-container",key:n},o.a.createElement(I,{key:n,externalFunction:function(){return e.invertState(n)},konvaIdName:"konva-".concat(n)}))):o.a.createElement("div",{className:"div-styling center-contents",key:n,style:{background:e.state.colours[n]}},o.a.createElement("a",{className:"initialiseButtonStyling initialiseButton center-contents",onClick:function(){return e.invertState(n)}},"Initialise Loop ",n+1))}),o.a.createElement("div",{className:"slidersDiv"},o.a.createElement("div",{className:"slider"},o.a.createElement("p",{className:"sliderTitle"},"Tempo: ",this.state.tempoValue),o.a.createElement(C.a,{value:this.state.tempoValue,orientation:"horizontal",onChange:function(t){return e.setBpm(t)},min:40,max:100,tooltip:!1})),o.a.createElement("div",{className:"slider"},o.a.createElement("p",{className:"sliderTitle"},"Volume: ",parseInt(this.convertRange(this.state.volume,[O,0],[0,100]),10)," "),o.a.createElement(C.a,{orientation:"horizontal",onChange:function(t){return e.setVolume(t)},value:this.state.volume,min:-40,max:0,tooltip:!1}))))}}]),t}(a.Component),B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function F(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(o.a.createElement(A,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/sjt-web-2",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/sjt-web-2","/service-worker.js");B?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):F(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):F(e)})}}()}},[[20,2,1]]]);
//# sourceMappingURL=main.36e330dc.chunk.js.map